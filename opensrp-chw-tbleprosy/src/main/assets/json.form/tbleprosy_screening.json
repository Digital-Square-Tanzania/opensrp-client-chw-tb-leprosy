{
  "validate_on_submit": true,
  "count": "4",
  "encounter_type": "TBLeprosy Screening",
  "entity_id": "",
  "metadata": {
    "start": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "start",
      "openmrs_entity_id": "163137AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "end": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "end",
      "openmrs_entity_id": "163138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "deviceid": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "deviceid",
      "openmrs_entity_id": "163149AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "subscriberid": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "subscriberid",
      "openmrs_entity_id": "163150AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "simserial": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "simserial",
      "openmrs_entity_id": "163151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "phonenumber": {
      "openmrs_entity_parent": "",
      "openmrs_entity": "concept",
      "openmrs_data_type": "phonenumber",
      "openmrs_entity_id": "163152AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    },
    "encounter_location": ""
  },
  "global": {},
  "step1": {
    "title": "TB/Leprosy Screening",
    "next": "step2",
    "fields": [
      {
        "key": "living_with_tb_leprosy_patient",
        "openmrs_entity_parent": "",
        "openmrs_entity": "",
        "openmrs_entity_id": "",
        "type": "native_radio",
        "label": "Living with, or near TB/Leprosy Patient",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please answer the question"
        },
        "options": [
          {
            "key": "yes",
            "text": "Yes",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "yes"
          },
          {
            "key": "no",
            "text": "No",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "no"
          }
        ]
      },
      {
        "key": "contact_lives_with_patient_type",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "contact_lives_with_patient_type",
        "type": "check_box",
        "label": "Client lives with/near which patient type?",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        },
        "options": [
          {
            "key": "tb",
            "text": "tb",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "tb"
          },
          {
            "key": "leprosy",
            "text": "Leprosy",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "leprosy"
          }
        ]
      },
      {
        "key": "do_you_know_clients_number",
        "openmrs_entity_parent": "",
        "openmrs_entity": "",
        "openmrs_entity_id": "",
        "type": "native_radio",
        "label": "Does the client know the TB/Leprosy index client number?",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please answer the question"
        },
        "options": [
          {
            "key": "yes",
            "text": "Yes",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "yes"
          },
          {
            "key": "no",
            "text": "No",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "no"
          }
        ],
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "tb_index_client_number",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "tb_index_client_number",
        "type": "mask_edit_text",
        "mask": "############-#/KK/####/###",
        "mask_hint": "07020110009752025431",
        "allowed_chars": "0123456789",
        "hint": "TB client number",
        "v_regex": {
          "value": "^\\d{12}-\\d/KK/\\d{4}/\\d{3}$",
          "err": "TB client number should follow this format (070201100097-5/KK/2025/431)"
        },
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "tb_client_names",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "tb_client_names",
        "type": "edit_text",
        "hint": "Names of the TB index client",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "leprosy_index_client_number",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "leprosy_index_client_number",
        "type": "mask_edit_text",
        "mask": "############-#/UK/555421/###",
        "mask_hint": "07020110009752025431",
        "allowed_chars": "0123456789",
        "hint": "Leprosy client number",
        "v_regex": {
          "value": "^\\d{12}-\\d/UK/\\d{4}/\\d{3}$",
          "err": "Leprosy client number should follow this format (070201100097-5/UK/2025/431)"
        },
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "leprosy_client_names",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "leprosy_client_names",
        "type": "edit_text",
        "hint": "Names of the leprosy index client",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "status",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "status",
        "type": "hidden",
        "hint": "client status",
        "value": "client"
      }
    ]
  },
  "step2": {
    "title": "Special Groups",
    "next": "step3",
    "fields": [
      {
        "key": "belongs_to_special_group",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "belongs_to_special_group",
        "type": "native_radio",
        "label": "Is the client part of a special group?",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "options": [
          {
            "key": "yes",
            "text": "Yes",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "yes"
          },
          {
            "key": "no",
            "text": "No",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "no"
          }
        ]
      },
      {
        "key": "client_special_group",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "client_special_group",
        "type": "native_radio",
        "label": "Select the client's special group",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "options": [
          {
            "key": "health_worker",
            "text": "Health worker",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "health_worker"
          },
          {
            "key": "miner",
            "text": "Miner (mining/quarry)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "miner"
          },
          {
            "key": "prisoner_or_staff",
            "text": "Prisoner/Prison staff",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "prisoner_or_staff"
          },
          {
            "key": "pwud",
            "text": "PWUD",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "pwud"
          },
          {
            "key": "fisherfolk",
            "text": "Fisherfolk (fishing camp)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "fisherfolk"
          },
          {
            "key": "refugee",
            "text": "Refugee",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "refugee"
          },
          {
            "key": "migrant",
            "text": "Migrant",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "migrant"
          },
          {
            "key": "slum_dweller",
            "text": "Slum dweller",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "slum_dweller"
          },
          {
            "key": "other_group",
            "text": "Other group (specify)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "other_group"
          }
        ],
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "other_special_group",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "other_special_group",
        "type": "edit_text",
        "hint": "Specify the other group",
        "v_required": {
          "value": "true",
          "err": "Please specify"
        },
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "screening_location",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "screening_location",
        "type": "native_radio",
        "label": "Where did the screening take place?",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "options": [
          {
            "key": "pharmacy",
            "text": "Pharmacy",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "pharmacy"
          },
          {
            "key": "traditional_healer",
            "text": "Traditional healer",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "traditional_healer"
          },
          {
            "key": "public_gathering",
            "text": "Public gathering",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "public_gathering"
          },
          {
            "key": "place_of_worship",
            "text": "Place of worship",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "place_of_worship"
          },
          {
            "key": "school_or_college",
            "text": "School/College",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "school_or_college"
          },
          {
            "key": "market",
            "text": "Market",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "market"
          },
          {
            "key": "other_location",
            "text": "Other location (specify)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "other_location"
          }
        ]
      },
      {
        "key": "other_screening_location",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "other_screening_location",
        "type": "edit_text",
        "hint": "Specify the other location",
        "v_required": {
          "value": "true",
          "err": "Please specify"
        },
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      }
    ]
  },
  "step3": {
    "title": "Investigation Findings",
    "next": "step4",
    "fields": [
      {
        "key": "selected_investigation_type",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "selected_investigation_type",
        "type": "native_radio",
        "label": "Select the type of investigation",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "options": [
          {
            "key": "tb",
            "text": "tb",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "tb"
          },
          {
            "key": "leprosy",
            "text": "Leprosy",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "leprosy"
          }
        ]
      },
      {
        "key": "tb_screening_findings",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "tb_screening_findings",
        "type": "check_box",
        "combine_checkbox_option_values": "true",
        "label": "TB screening findings",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "exclusive": [
          "no_tb_signs"
        ],
        "options": [
          {
            "key": "persistent_cough",
            "text": "Persistent cough (KH)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "persistent_cough"
          },
          {
            "key": "sputum_with_blood",
            "text": "Sputum mixed with blood (D)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "sputum_with_blood"
          },
          {
            "key": "fever",
            "text": "Fever (H)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "fever"
          },
          {
            "key": "weight_loss",
            "text": "Weight loss (KU)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "weight_loss"
          },
          {
            "key": "night_sweats",
            "text": "Excessive night sweats",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "night_sweats"
          },
          {
            "key": "extra_pulmonary_tb_signs",
            "text": "Extra-pulmonary TB signs (specify)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "extra_pulmonary_tb_signs"
          },
          {
            "key": "no_tb_signs",
            "text": "No signs",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "no_tb_signs"
          }
        ],
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "leprosy_screening_findings",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "leprosy_screening_findings",
        "type": "check_box",
        "combine_checkbox_option_values": "true",
        "label": "Leprosy screening findings",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "exclusive": [
          "no_leprosy_signs"
        ],
        "options": [
          {
            "key": "numb_patches",
            "text": "Patches or plaques without sensation (B)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "numb_patches"
          },
          {
            "key": "skin_nodules_or_thickening",
            "text": "Skin nodules or thickening (NV)",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "skin_nodules_or_thickening"
          },
          {
            "key": "numbness_hands_or_feet",
            "text": "Numbness of hands or feet",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "numbness_hands_or_feet"
          },
          {
            "key": "disability_or_chronic_ulcers",
            "text": "Disability or chronic ulcers",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "disability_or_chronic_ulcers"
          },
          {
            "key": "no_leprosy_signs",
            "text": "No signs",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "no_leprosy_signs"
          }
        ],
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "screening_status",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "screening_status",
        "type": "hidden",
        "calculation": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_calculation.yml"
            }
          }
        }
      },
      {
        "key": "non_presumptive_prompt",
        "type": "toaster_notes",
        "text": "Client has no signs of TB or leprosy at this time.",
        "toaster_info_title": "No TB or leprosy signs found",
        "toaster_info_text": "Client shows no TB or leprosy signs during this screening.",
        "openmrs_entity_parent": "",
        "openmrs_entity": "",
        "openmrs_entity_id": "",
        "toaster_type": "info",
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      },
      {
        "key": "leprosy_referral_prompt",
        "type": "toaster_notes",
        "text": "Client has leprosy signs. Provide a referral to a health facility.",
        "toaster_info_title": "Refer the client to a health facility",
        "toaster_info_text": "Client is presumptive for leprosy. Prepare and issue a referral for further assessment at a health facility.",
        "openmrs_entity_parent": "",
        "openmrs_entity": "",
        "openmrs_entity_id": "",
        "toaster_type": "warning",
        "relevance": {
          "rules-engine": {
            "ex-rules": {
              "rules-file": "tbleprosy_screening_relevance.yml"
            }
          }
        }
      }
    ]
  },
  "step4": {
    "title": "HIV Screening",
    "fields": [
      {
        "key": "hiv_tested",
        "openmrs_entity_parent": "",
        "openmrs_entity": "concept",
        "openmrs_entity_id": "hiv_tested",
        "type": "native_radio",
        "label": "Has the client tested for HIV?",
        "label_text_size": "18px",
        "v_required": {
          "value": "true",
          "err": "Please provide this information"
        },
        "options": [
          {
            "key": "yes",
            "text": "Yes",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "yes"
          },
          {
            "key": "no",
            "text": "No",
            "openmrs_entity": "concept",
            "openmrs_entity_id": "no"
          }
        ]
      }
    ]
  }
}
